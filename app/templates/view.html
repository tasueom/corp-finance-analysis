{% extends "layout.html" %}

{% block title %}
    재무상태표 데이터 조회
{% endblock %}

{% block content %}
<h2>재무상태표 데이터 조회</h2>

<div class="download-buttons">
    <p>전체 재무상태표 다운로드</p>
    <a href="{{ url_for('export_csv') }}" class="btn-download btn-csv" title="CSV 다운로드">
        <i class="fas fa-file-csv"></i>
    </a>
    <a href="{{ url_for('export_json')}}" class="btn-download btn-json" title="JSON 다운로드">
        <i class="fas fa-file-code"></i>
    </a>
</div>

<form method="post">
    <input type="hidden" name="action" value="select_corp">

    <select name="corp_name" onchange="this.form.submit()">
        <option value="" disabled hidden {% if not selected_corp %}selected{% endif %}>기업선택</option>
        {% for c in corp_list %}
            <option value="{{ c[0] }}" {% if selected_corp == c[0] %}selected{% endif %}>
                {{ c[0] }}
            </option>
        {% endfor %}
    </select>
</form>

{% if selected_corp %}

<form method="post">
    <input type="hidden" name="action" value="select_year">
    <input type="hidden" name="corp_name" value="{{ selected_corp }}">

    <select name="year" onchange="this.form.submit()">
        <option value="" disabled hidden {% if not selected_year %}selected{% endif %}>연도선택</option>
        {% for y in years %}
            <option value="{{ y[0] }}" {% if selected_year and selected_year|string == y[0]|string %}selected{% endif %}>
                {{ y[0] }}
            </option>
        {% endfor %}
    </select>
</form>
{% endif %}

{% if rows %}

<h3>{{ selected_corp }} — {{ selected_year }}년 재무상태표</h3>

<table id="data-table">
    <thead>
        <tr>
            <th>계정명</th>
            <th>금액</th>
        </tr>
    </thead>
    <tbody>
        {% for r in rows %}
        <tr>
            <td>{{ r[0] }}</td>
            <td>{{ "{:,}".format(r[1]) }}</td>
        </tr>
    {% endfor %}
    </tbody>
</table>
{% endif %}

{% endblock %}